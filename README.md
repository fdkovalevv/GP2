# GP2
# Сбор и анализ данных ресторанов Москвы с использованием API 2GIS и парсинга Яндекс.Карт

В данном репозитории представлен проект по сбору и анализу данных о ресторанах Москвы с использованием API 2GIS и парсинга веб-страниц Яндекс.Карт.

## Описание

Основной целью проекта является сбор и анализ данных о ресторанах Москвы для получения информации, которая может быть полезна при выборе места для открытия нового заведения.

Для сбора данных использовались два популярных сервиса карт в СНГ:

* **2GIS:** Основной источник данных, предоставляющий информацию через API.
* **Яндекс.Карты:** Дополнительный источник данных, для получения информации, недоступной через API 2GIS.

## Содержание

* **2GIS_API.ipynb:** Код для сбора данных с использованием API 2GIS.
* **parser.ipynb:** Код для парсинга данных с веб-страниц Яндекс.Карт.
* **ГП_2_обработка_данных.ipynb:** Код очистки данных, заполнения пропусков, фильтрации и создания более удобных в применении столбцов на основе изначальных данных
* **2GIS_final_filtered.csv:** Итоговый датасет, содержащий собранные и обработанные данные.
* **requirements.txt:** Файл со списком необходимых библиотек.

### Пропущенные значения до очистки и заполнения
![Image alt](https://github.com/fdkovalevv/GP2/raw/develop/images/До_очистки.jpeg)

### Описание данных после извлечения с 2GIS и Яндекс.Карт
* **Address_comment:** Номер этажа, на котором находится ресторан.
* **address_name:** Адрес заведения.
* **building_name:** Тип здания, в котором расположен ресторан.
* **Restaurant_name:** Название ресторана.
* **Brief_description:** Краткое описание ресторана.
* **point:** Географические координаты (долгота и широта).
* **postcode:** Почтовый индекс.
* **Count_branches:** Количество филиалов.
* **Type_of_institution:** Категории заведения (по данным 2GIS).
* **general_rating:** Рейтинг ресторана (филиала).
* **general_review_count:** Количество текстовых отзывов.
* **general_review_count_with_stars:** Количество оценок.
* **org_rating:** Рейтинг организации (всех филиалов).
* **org_review_count:** Суммарное количество текстовых отзывов.
* **org_review_count_with_stars:** Суммарное количество оценок.
* **working_days:** График работы (дни).
* **working_hours:** График работы (часы).
* **restaurant_category:** Категории заведения (по данным Яндекс.Карт).
* **transport_connection:** Информация о транспортной доступности (метро, автобус).
* **Cusiene:** Тип кухни.
* **Average_bill:** Диапазон среднего чека.
* **Price_level:** Уровень цен.

### Пропущенные значения после очистки и заполнения
![Image alt](https://github.com/fdkovalevv/GP2/raw/develop/images/После_очистки_1.jpeg)
![Image alt](https://github.com/fdkovalevv/GP2/raw/develop/images/После_очистки_2.jpeg)


## Описание датасета (2GIS_final_filtered.csv)

Датасет содержит следующие столбцы:

* **Address_comment:** Номер этажа, на котором находится ресторан.
* **address_name:** Адрес заведения.
* **building_name:** Тип здания, в котором расположен ресторан.
* **Restaurant_name:** Название ресторана.
* **Brief_description:** Краткое описание ресторана.
* **point:** Географические координаты (долгота и широта).
* **postcode:** Почтовый индекс.
* **Count_branches:** Количество филиалов.
* **Type_of_institution:** Категории заведения (по данным 2GIS).
* **general_rating:** Рейтинг ресторана (филиала).
* **general_review_count:** Количество текстовых отзывов.
* **general_review_count_with_stars:** Количество оценок.
* **org_rating:** Рейтинг организации (всех филиалов).
* **org_review_count:** Суммарное количество текстовых отзывов.
* **org_review_count_with_stars:** Суммарное количество оценок.
* **working_days:** График работы (дни).
* **working_hours:** График работы (часы).
* **restaurant_category:** Категории заведения (по данным Яндекс.Карт).
* **transport_connection:** Информация о транспортной доступности (метро, автобус).
* **Cusiene:** Тип кухни.
* **Average_bill:** Диапазон среднего чека.
* **Price_level:** Уровень цен.
* **nearest_metro:** Ближайшая станция метро.
* **metro_dist:** Расстояние до метро.
* **nearest_bus:** Ближайшая автобусная остановка.
* **bus_dist:** Расстояние до остановки.
* **is_restaurant, is_cafe, is_coffee_shop, is_bar, is_bakery, is_other:** Флаги категорий заведения.
* **distance_to_center_km:** Расстояние до центра Москвы.


## Установка зависимостей

Для установки необходимых библиотек выполните следующую команду:

```bash
pip install -r requirements.txt
```

## Настройка окружения
Для работы с API 2GIS необходимо добавить API ключ в файл .env в корневом каталоге проекта.

1. Создайте файл .env.
2. Добавьте строку: API_2GIS=ваш_API_ключ.
Убедитесь, что файл .env добавлен в .gitignore для предотвращения публикации ключа.

## Использование
1. Клонируйте репозиторий.
2. Создайте виртуальное окружение (рекомендуется).
3. Установите необходимые библиотеки с помощью команды pip install -r requirements.txt.
4. Добавьте ваш API ключ 2GIS в файл .env, как описано в разделе "Настройка окружения".
5. Запустите ноутбук 2GIS_API.ipynb для сбора данных с API 2GIS.
6. Запустите ноутбук parser.ipynb для парсинга данных с Яндекс.Карт.
7. Запустите ноутбук ГП_2_обработка_данных.ipynb для очистки и обработки данных.
8. Изучите итоговый датасет 2GIS_final_filtered.csv.
9. Запустите GP2_EDA.ipynb для построения графиков и просмотра выводов.

## Раздел EDA и графики

### Часто ли у самых популярных ресторанов есть накрученные отзывы  (рейтинг высокий, количество отзывов большое, а процент, написанных словами (не просто оценка), минимальный.

![Image alt](https://github.com/fdkovalevv/GP2/raw/develop/images/зависимость_проц_текстовых_отзывов_от_колва_отзывов.jpg)
![Image alt](https://github.com/fdkovalevv/GP2/raw/develop/images/зависимость_рейтинга_от_колва_отзывов.jpg)
![Image alt](https://github.com/fdkovalevv/GP2/raw/develop/images/зависимость_проц_текстовых_отзывов_от_рейтинга.jpg)

Выводы: наибольшее количество заведений имеет до 300 отзывов, из которых 40-50% текстовых, и очень высокий рейтинг (около 5). У ресторанов с наибольшим количеством отзывов в среднем рейтинг выше и чуть больше процент текстовых. Популярные рестораны НЕ накручивают отзывы.

### Зависит ли популярность ресторана от его местоположение относительно центра?

![Image alt](https://github.com/fdkovalevv/GP2/raw/develop/images/плотность_ресторанов_от_расстояния_до_центра.jpg)
![Image alt](https://github.com/fdkovalevv/GP2/raw/develop/images/распределение_ресторанов_по_удаленности_от_центра.jpg)
![Image alt](https://github.com/fdkovalevv/GP2/raw/develop/images/средний_рейтинг_ресторанов_в_зависимости_от_расстояния_до_центра.jpg)
![Image alt](https://github.com/fdkovalevv/GP2/raw/develop/images/среднее_колво_оценок_ресторанов_в_зависимости_от_расстояния_до_центра.jpg)
![Image alt](https://github.com/fdkovalevv/GP2/raw/develop/images/зависимость_колва_оценок_от_удаленности_от_центра.jpg)
![Image alt](https://github.com/fdkovalevv/GP2/raw/develop/images/зависимость_рейтинга_от_расстояниия_до_центра.jpg)

Выводы: большее число ресторанов находится в пределах 6 км от центра (есть большая просадка до 1 км и небольшая просадка в диапазоне 4-5 км), что можно объяснить популярностью центра Москвы. Далее этот показатель уменьшается. Очень большой показатель плотности ресторанов в пределах 2 км от центра, высокая от 2 до 4 км, средняя от 4 до 6. В остальных диапазонах плотность очень низкая. Рейтинг не зависит от расстояния (в каждом диапазоне около 4 и постоянно колеблется). А вот популярность сильно зависит от этого показателя, среднее количество отзывов у ресторанов ближе к центру самое высокое.Также можно заметить, что из-за высокой плотности ресторанов людям свойственно не оставлять отзывы о них.

### На сколько расположение ресторана на первом этаже (в отдельном заведении в частности) влияет на количество посетителей и рейтинг заведения?

![Image alt](https://github.com/fdkovalevv/GP2/raw/develop/images/анализ_по_этажам.jpg)

Выводы: действительно, ресторанов на 1 этаже в 4-5 раз больше чем на всех остальных, это может быть связано с лучшей доступностью, хорошей видимостью, высокой проходимостью и привлекательностью для случайных посетителей. Рейтинг таких ресторанов тоже выше, что говорит о более приятном впечатлении клиентов о таких заведениях. Среднее количество отзывов сильно выше только у заведений, которые находятся в отдельных зданиях. Действительно, проходимость в торговых центрах высокая независимо от этажа, а в отдельных заведениях люди предпочитают принимать пищу на первых этажах.

### Исследование зависимости рейтинга заведения от времени его работы

![Image alt](https://github.com/fdkovalevv/GP2/raw/develop/images/часы_открытия_ресторанов.jpg)
![Image alt](https://github.com/fdkovalevv/GP2/raw/develop/images/часы_закрытия_ресторанов.jpg)
![Image alt](https://github.com/fdkovalevv/GP2/raw/develop/images/анализ_режима_работы.jpg)

Выводы: здесь мы получаем неожиданный результат. Во всех категориях заведений рейтинг выше, если ночные часы работы не включены. Значит ли это что за ними плохо следят или ночами там собирается нежелательный контингент - сказать не можем, однако делаем вывод что не имеет смысла включать ночное время в свой режим работы.

### Выгоднее открыть локальный ресторан или работать по франшизе?

![Image alt](https://github.com/fdkovalevv/GP2/raw/develop/images/среднее_колво_отзывов_франшиз_и_не.png)
![Image alt](https://github.com/fdkovalevv/GP2/raw/develop/images/средний_рейтинг_франшиз_и_не.jpg)
![Image alt](https://github.com/fdkovalevv/GP2/raw/develop/images/топ_20_по_колву_отзывов_франшизы_и_не.jpg)

Выводы: выделив лучшие рестораны можно увидеть большое количество франшиз и отдельных заведений с рейтингом 5, но по среднему рейтингу франшизы сильно уступают. Также, сравнив рестораны с наибольшим количеством отзывов и средние показатели всех, можно сделать вывод, что в среднем франшизы популярнее, так как много тратят на рекламу всего бренда, но самые лучшие отдельные заведения клиенты предпочитают больше. Есть риск открывать отдельный ресторан, но он оправдан.

### Исследование зависимости рейтинга и кол-ва оценок и отзывов заведения от принадлежности к сети

![Image alt](https://github.com/fdkovalevv/GP2/raw/develop/images/сравнение_характеристик_сетевых_и_не.jpg)

Выводы: рейтинг индивидуальных заведений имеет больший разброс в обе стороны, медианный же рейтинг примерно одинаковый для сетевых и несетевых заведений. Однако разброс в сторону отрицательных значений у индивидуальных заведений значительно больше, чем у сетевых.
Количество текстовых отзывов у сетевых ресторанов выше чем у индивидуальных
С количеством оценок ситуация аналогичная - сетевые рестораны получают гораздо больше оценок. Их медианное значение находится практически на одном уровне с третьим квартилем индивидуальных заведений.
Эти факты можно интерпретировать по-разному, однако вывод остаётся одним - люди предпочитают сетевые рестораны индивидуальным.

## Заключение

Итоговый портрет ресторана: 
* Местоположение: 6-7 км от центра;
* Этажность: на первом этаже;
* Режим работы: с 8 до 23;
* Франчайзинг: в среднем сетевые заведения показывают себя увереннее, если предприниматель знает что делоднакоает и владеет необходимыми ресурсами – частное заведение принесёт большую выгоду.